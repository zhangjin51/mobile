(self["webpackChunkhelloworld"]=self["webpackChunkhelloworld"]||[]).push([[143],{9918:function(t,e,s){"use strict";var a=s(6369),n=(s(9491),s(6450)),o=s(2631),r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"home"},[e("ComHeader"),e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[t.bannerList.length>0?e("div",{staticClass:"banner"},[e("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3,"indicator-color":"white"}},t._l(t.bannerList,(function({bannerid:t,img:s,alt:a}){return e("van-swipe-item",{key:t},[e("img",{attrs:{src:s,alt:a}})])})),1)],1):t._e(),e("div",{staticClass:"nav"},[e("van-grid",{attrs:{"column-num":"5","icon-size":"35",clickable:"",border:!1}},t._l(t.gridList,(function(s){return e("van-grid-item",{key:s.id,staticClass:"temp",attrs:{icon:s.url,text:s.text},on:{click:function(e){return t.handleGriditemClick(s.id)}}})})),1)],1),e("div",{staticClass:"miaosha"},[e("div",{staticClass:"miaosha-header"},[e("h3",{staticClass:"miaosha-title"},[t._v("京东秒杀")]),e("div",{staticClass:"miaosha-hour"},[t._v(t._s(t._f("format")(t.hour))+"点场")]),e("van-count-down",{attrs:{time:t.time,format:"DD 天 HH 时 mm 分 ss 秒"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticClass:"block"},[t._v(t._s(t._f("format")(s.hours)))]),e("span",{staticClass:"colon"},[t._v(":")]),e("span",{staticClass:"block"},[t._v(t._s(t._f("format")(s.minutes)))]),e("span",{staticClass:"colon"},[t._v(":")]),e("span",{staticClass:"block"},[t._v(t._s(t._f("format")(s.seconds)))])]}}])})],1),e("div",{staticClass:"miaosha-content"},t._l(t.miaoshaList,(function(s){return e("div",{key:s.proid,staticClass:"content-item"},[e("img",{attrs:{src:s.img1,alt:""}}),e("p",{staticClass:"price"},[t._v("$"+t._s(s.originprice))])])})),0),e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.getGoodsData},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[e("GoodsList",{ref:"goodList",attrs:{goodsList:t.goodsList}})],1)],1)])],1)},i=[],l=s(6265),c=s.n(l),d=s(5410),u=s.n(d);switch("production"){case"production":c().defaults.baseURL="http://121.89.205.189:3001/api";break;case"test":c().defaults.baseURL="http://test.com:3000/";break;default:c().defaults.baseURL="/api";break}c().defaults.timeout=5e3,c().defaults.withCredentials=!1,c().defaults.headers["Content-Type"]="application/x-www-form-urlencoded",c().defaults.transformRequest=t=>u().stringify(t),c().interceptors.request.use((t=>{let e=localStorage.getItem("token");return e&&(t.headers.token=e),t}),(t=>Promise.reject(t))),c().defaults.validateStatus=t=>/^2|3\d{2}$/.test(t),c().interceptors.response.use((t=>(console.log(t),t.data&&"200"===t.data.code?(t.data.data&&t.data.data.token&&localStorage.setItem("token",t.data.data.token),t.data):("10119"===t.data.code&&(console.log("token失效，删除token"),localStorage.removeItem("token"),Ge.replace("/login")),(0,n.Z)({type:"danger",message:t.data.message}),t.data))),(t=>{let{response:e}=t;if(!e)return window.navigator.onLine?(console.log("!@#someerror"),Promise.reject(t)):void 0;switch(e.status){case 401:break;case 403:localStorage.removeItem("token");break;case 404:break}}));var h=c();class m{static getInstance(){return this.instance||(this.instance=new m),this.instance}constructor(){this.cache=new Map}request(t){const{method:e,url:s,params:a}=t;let n=s;if("get"===e&&a)for(let o in a)n+=o+a[o];return this.cache.has(n)?Promise.resolve(this.cache.get(n)):h(t).then((t=>("get"===e&&this.cache.set(n,t),t)))}}var p=m.getInstance();function g(){return p.request({url:"/banner/list",method:"get",params:{id:123}})}function f(){return p.request({url:"/pro/seckilllist",method:"get",params:{count:1}})}function v(t){return p.request({url:"pro/list",method:"get",params:{count:t}})}var b=function(){var t=this,e=t._self._c;return e("div",{staticClass:"goods-list-container"},t._l(t.goodsList,(function(s){return e("van-cell",{key:s.proid,staticClass:"good-item",on:{click:function(e){return t.handleCellClick(s.proid)}}},[e("div",{staticClass:"item-image"},[e("img",{attrs:{src:s.img1,alt:""}})]),e("div",{staticClass:"item-info ignore"},[e("p",{staticClass:"item-intro van-multi-ellipsis--l2"},[t._v(" "+t._s(s.proname)+" ")]),e("p",{staticClass:"item-price"},[t._v(" ￥"),e("span",{staticClass:"price-value"},[t._v(t._s(s.originprice))])])])])})),1)},k=[],C={props:["goodsList"],methods:{handleCellClick(t){this.$router.push({name:"details",params:{id:t}})}}},w=C,y=s(1001),_=(0,y.Z)(w,b,k,!1,null,"356953a6",null),x=_.exports,L=function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[e("van-nav-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[e("router-link",{attrs:{to:"/city",tag:"div"}},[t._v("城市")])]},proxy:!0},{key:"title",fn:function(){return[e("router-link",{attrs:{to:"/search",tag:"div"}},[t._v("卡姿兰大眼睛")])]},proxy:!0},{key:"right",fn:function(){return[t.userid?e("router-link",{attrs:{to:"/user",tag:"div"}},[t._v("我的")]):e("router-link",{attrs:{to:"/login",tag:"div"}},[t._v("登录")])]},proxy:!0}])})],1)},S=[],$=s(3822),Z={computed:{...(0,$.rn)("user",["userid"])}},I=Z,q=(0,y.Z)(I,L,S,!1,null,"819abf8a",null),D=q.exports,A={name:"HomeView",components:{GoodsList:x,ComHeader:D},data(){return{bannerList:[],gridList:[{id:this.$nanoid(),text:"京东超市",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/175540/24/19329/6842/60ec0b0aEf35f7384/ec560dbf9b82b90b.png!q70.jpg"},{id:this.$nanoid(),text:"数码电器",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/178015/31/13828/6862/60ec0c04Ee2fd63ac/ccf74d805a059a44.png!q70.jpg"},{id:this.$nanoid(),text:"京东新百货",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/54043/33/19389/4660/62b049dbE3b9aef75/2fcd31afd5d702e4.png!q70.jpg"},{id:this.$nanoid(),text:"京东生鲜",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/177902/16/13776/5658/60ec0e71E801087f2/a0d5a68bf1461e6d.png!q70.jpg"},{id:this.$nanoid(),text:"京东到家",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/196472/7/12807/7127/60ec0ea3Efe11835b/37c65625d94cae75.png!q70.jpg"},{id:this.$nanoid(),text:"京东超市",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/175540/24/19329/6842/60ec0b0aEf35f7384/ec560dbf9b82b90b.png!q70.jpg"},{id:this.$nanoid(),text:"数码电器",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/178015/31/13828/6862/60ec0c04Ee2fd63ac/ccf74d805a059a44.png!q70.jpg"},{id:this.$nanoid(),text:"京东新百货",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/54043/33/19389/4660/62b049dbE3b9aef75/2fcd31afd5d702e4.png!q70.jpg"},{id:this.$nanoid(),text:"京东生鲜",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/177902/16/13776/5658/60ec0e71E801087f2/a0d5a68bf1461e6d.png!q70.jpg"},{id:this.$nanoid(),text:"京东到家",url:"https://m15.360buyimg.com/mobilecms/jfs/t1/196472/7/12807/7127/60ec0ea3Efe11835b/37c65625d94cae75.png!q70.jpg"}],miaoshaList:[],time:0,hour:0,isLoading:!1,goodsList:[],currentCount:1,loading:!1,finished:!1}},filters:{format(t){return t<10?"0"+t:t}},created(){this.getRemainTime(),g().then((t=>{this.bannerList=t.data})).catch((t=>{console.error(t)})),f().then((t=>{this.miaoshaList=t.data})).catch((t=>{console.error(t)}))},mounted(){},methods:{handleGriditemClick(t){console.log(t)},getRemainTime(){const t=new Date;let e=t.getHours(),s=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();e+=e%2===0?2:1,this.hour=e-2,24===e&&(e=0,n+=1,(31===n&&-1===[1,3,5,7,8,10,11].indexOf(a)||32===n&&-1!==[1,3,5,7,8,10,11].indexOf(a))&&(n=1,a+=1,13===a&&(a=1,s+=1))),this.time=new Date(`${s}/${a}/${n} ${e}:00:00`).getTime()-t.getTime()},getGoodsData(){return console.log(this.currentCount),this.loading=!0,v(this.currentCount++).then((t=>{if(this.loading=!1,0===t.data.length)return this.finished=!0,!1;this.goodsList=this.goodsList.concat(t.data)})).catch((t=>{console.error(t)}))},onRefresh(){this.currentCount=1,this.goodsList=[],this.getGoodsData().then((()=>{this.isLoading=!1}))}}},P=A,j=(0,y.Z)(P,r,i,!1,null,"54c16bea",null),E=j.exports,T=function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer-container"},[e("van-tabbar",{attrs:{route:""}},[e("van-tabbar-item",{attrs:{to:"/",icon:"home-o"}},[t._v("home")]),e("van-tabbar-item",{attrs:{to:"/cart",icon:"cart-o"}},[t._v("cart")]),e("van-tabbar-item",{attrs:{to:t.userPath,icon:"user-o"}},[t._v(t._s(t.userContent))])],1)],1)},R=[];const{mapState:N}=(0,$._p)("user");var G={data(){return{}},computed:{...N(["userid"]),userContent(){return localStorage.getItem("token")?"user":"login"},userPath(){return localStorage.getItem("token")?"/user":"/login"}}},O=G,V=(0,y.Z)(O,T,R,!1,null,"4fb2c499",null),F=V.exports,H=function(){var t=this,e=t._self._c;return e("div",{staticClass:"details-root"},[e("van-nav-bar",{attrs:{title:"详情","left-text":"返回","left-arrow":""},on:{"click-left":function(e){return t.$router.back()}},scopedSlots:t._u([{key:"right",fn:function(){return[e("van-popover",{attrs:{theme:"dark",trigger:"click",actions:t.actions,placement:"bottom-end"},on:{select:t.onSelect},scopedSlots:t._u([{key:"reference",fn:function(){return[e("van-icon",{attrs:{name:"ellipsis",size:"30"}})]},proxy:!0}]),model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}})]},proxy:!0}])}),e("van-share-sheet",{attrs:{title:"立即分享给好友",options:t.shareOptions},on:{select:t.onShareSelect},model:{value:t.showShare,callback:function(e){t.showShare=e},expression:"showShare"}}),e("div",{staticClass:"content"},[e("div",{staticClass:"banner"},[e("van-swipe",{ref:"swipe"},t._l(t.detailBanners,(function(s,a){return e("van-swipe-item",{key:a,on:{click:function(e){return t.handleSwipeItemClick(a)}}},[e("img",{attrs:{src:s,alt:"",srcset:""}})])})),1),e("div",{staticClass:"btn-play ignore",on:{click:t.handleVideoPlay}},[e("van-icon",{attrs:{name:"play-circle"}}),e("span",{staticClass:"time"},[t._v(t._s(t.videoTime))])],1),e("van-popup",{on:{close:t.handlePopupClose},model:{value:t.showVideo,callback:function(e){t.showVideo=e},expression:"showVideo"}},[e("video",{ref:"video",attrs:{controls:"",preload:"",src:"https://jvod.300hu.com/vod/product/b1024a62-8c46-464c-8ec7-f57d26cceb38/42f70c8e8bbb442e986874ec556fc882.mp4"}})])],1),e("h3",{staticClass:"price"},[t._v(" ￥ "),e("span",{staticClass:"price-value"},[t._v(t._s(t.price))])]),e("h3",{staticClass:"detail-name"},[e("van-tag",{attrs:{type:"danger"}},[t._v("自营")]),e("span",{staticClass:"name"},[t._v(t._s(t.proname))])],1)]),e("div",{staticClass:"details-footer"},[e("van-goods-action",[e("van-goods-action-icon",{attrs:{icon:"chat-o",text:"客服",dot:""}}),e("van-goods-action-icon",{attrs:{icon:"cart-o",text:"购物车",badge:t.totalNum},on:{click:t.handleGoToCart}}),e("van-goods-action-icon",{attrs:{icon:"shop-o",text:"店铺",badge:"12"}}),e("van-goods-action-button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],attrs:{type:"warning",text:"加入购物车"},on:{click:t.handleAddCart}}),e("van-goods-action-button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],attrs:{type:"danger",text:"立即购买"}}),e("van-goods-action-button",{directives:[{name:"show",rawName:"v-show",value:!t.flag,expression:"!flag"}],attrs:{disabled:"",type:"danger",text:"已下架"}})],1)],1)],1)},U=[];function z(t){return p.request({url:`/pro/detail/${t}`,method:"get"})}function B(t){return p.request({url:"/cart/list",method:"post",data:t})}function M(t){return p.request({url:"/cart/add",method:"post",data:t})}function J(t){return p.request({url:"/cart/remove",method:"post",data:t})}function K(t){return p.request({url:"/cart/updatenum",method:"post",data:t})}function Y(t){return p.request({url:"/cart/selectone",method:"post",data:t})}function Q(t){return p.request({url:"/cart/selectall",method:"post",data:t})}function W(t){return p.request({url:"/pro/recommendlist",method:"get",params:{...t}})}const{mapState:X}=(0,$._p)("user"),tt=(0,$._p)("cart");var et={data(){return{showPopover:!1,actions:[{text:"首页",icon:"wap-home-o",name:"home"},{text:"购物车",icon:"shopping-cart-o",name:"cart"},{text:"分享",icon:"share-o",name:"share"}],showShare:!1,shareOptions:[{name:"微信",icon:"wechat"},{name:"微博",icon:"weibo"},{name:"复制链接",icon:"link"},{name:"分享海报",icon:"poster"},{name:"二维码",icon:"qrcode"}],detailBanners:[],proname:"",price:0,flag:!0,videoTime:"00′55″",showVideo:!1}},created(){z(this.$route.params.id).then((t=>{this.detailBanners=t.data.banners[0].split(","),this.proname=t.data.proname,this.price=t.data.originprice})).catch((t=>console.error(t))),this.getCartListData(this.userid)},activated(){z(this.$route.params.id).then((t=>{this.detailBanners=t.data.banners[0].split(","),this.proname=t.data.proname,this.price=t.data.originprice})).catch((t=>console.error(t)))},computed:{...X(["userid"]),...tt.mapGetters(["totalNum"])},methods:{...tt.mapActions(["getCartListData"]),onSelect(t){this.showPopover=!1,"share"===t.name?this.showShare=!0:this.$router.push({name:t.name})},onShareSelect(t){this.$toast(t.name),this.showShare=!1},handleVideoPlay(){this.showVideo=!0,this.$nextTick((()=>{console.log(this.$refs.video.duration),this.$refs.video.play()}))},handlePopupClose(){this.$refs.video.currentTime=0,this.$refs.video.pause()},handleSwipeItemClick(t){this.$imagePreview({images:this.detailBanners,startPosition:t,onChange:t=>{this.$refs.swipe.swipeTo(t)},closeable:!0})},handleAddCart(){const t=localStorage.getItem("token");t?(console.log("add cart"),M({userid:this.userid,proid:this.$route.params.id,num:1}).then((t=>{"200"===t.code&&(this.getCartListData(this.userid),this.$notify({type:"danger",message:"加入成功"})),console.log("cartadd",t)}))):this.$router.push({path:"/login",query:{back:this.$route.path}})},handleGoToCart(){this.$router.push("/cart")}}},st=et,at=(0,y.Z)(st,H,U,!1,null,"62be53bc",null),nt=at.exports,ot=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notfound-container"},[e("div",{staticClass:"header"},[e("van-nav-bar",{attrs:{"left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)}}})],1),e("div",{staticClass:"content"},[e("van-empty",{attrs:{image:"error",description:"404 暂无该页面~"}})],1)])},rt=[],it={},lt=it,ct=(0,y.Z)(lt,ot,rt,!1,null,null,null),dt=ct.exports,ut=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("van-nav-bar",{attrs:{title:"京东注册","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),e("router-view",{staticClass:"child"})],1)},ht=[],mt={name:"RegisterView",methods:{onClickLeft(){this.$router.back()}}},pt=mt,gt=(0,y.Z)(pt,ut,ht,!1,null,"46d61758",null),ft=gt.exports,vt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("van-field",{staticClass:"input",attrs:{type:"tel",label:"请输入手机号"},model:{value:t.tel,callback:function(e){t.tel=e},expression:"tel"}}),e("van-button",{attrs:{type:"danger",disabled:!t.disable,round:"",block:""},on:{click:t.handleNext}},[t._v("下一步")])],1)},bt=[];function kt(t){return p.request({url:"/user/docheckphone",method:"post",data:t})}function Ct(t){return p.request({url:"/user/dosendmsgcode",method:"post",data:t})}function wt(t){return p.request({url:"/user/docheckcode",method:"post",data:t})}function yt(t){return p.request({url:"/user/dofinishregister",method:"post",data:t})}function _t(t){return p.request({url:"/user/login",method:"post",data:t})}var xt={data(){return{tel:""}},created(){console.log(/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(this.tel))},methods:{handleNext(){kt({tel:this.tel}).then((t=>{console.log(t),"200"===t.code?this.$dialog.confirm({title:"提示",message:`将向手机号：${this.tel}发送短线验证码`}).then((()=>{this.$store.commit("login/setTel",this.tel),this.$router.push("/register/step2")})).catch((()=>{})):this.$dialog.confirm({title:"提示",message:"手机号已注册，是否去登录"}).then((()=>{this.$router.go(-1)})).catch((()=>{}))}))}},computed:{disable(){return/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(this.tel)}}},Lt=xt,St=(0,y.Z)(Lt,vt,bt,!1,null,"dad5523a",null),$t=St.exports,Zt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("van-field",{attrs:{center:"",clearable:"",label:"短信验证码",placeholder:"请输入短信验证码"},scopedSlots:t._u([{key:"button",fn:function(){return[e("van-button",{attrs:{disabled:t.msgcodeFlag,size:"small",round:"",type:"danger"},on:{click:t.sendMessage}},[t._v(t._s(t.msgCodeContent))])]},proxy:!0}]),model:{value:t.sms,callback:function(e){t.sms=e},expression:"sms"}}),e("van-button",{attrs:{type:"danger",disabled:!t.btnNextFlag,round:"",block:""},on:{click:t.handleNext}},[t._v("下一步")])],1)},It=[];const{mapState:qt}=(0,$._p)("login");var Dt={data(){return this.time=0,{sms:"",msgCodeContent:"发送验证码",timer:null}},created(){if(localStorage.getItem("time")){const t=localStorage.getItem("time").split("_"),e=(new Date).getTime()-1*t[0];Math.round(e/1e3)<1*t[1]&&this.countdown(1*t[1]-Math.round(e/1e3))}},mounted(){window.onbeforeunload=this.saveRemainTime.bind(this)},beforeDestroy(){clearInterval(this.timer),this.saveRemainTime()},computed:{...qt(["tel"]),msgcodeFlag(){return"发送验证码"!==this.msgCodeContent},btnNextFlag(){return/^\d{5}$/.test(this.sms)}},methods:{handleNext(){wt({tel:this.tel,telcode:this.sms}).then((t=>{console.log(t),"10007"===t.code?this.$notify({type:"danger",message:t.message}):this.$router.push("/register/step3")})).catch((t=>{console.log(t)}))},countdown(t){clearInterval(this.timer),this.time=t||60,this.timer=setInterval((()=>{this.msgCodeContent=--this.time+"s 后再次发送",0===this.time&&(this.msgCodeContent="发送验证码",clearInterval(this.timer),localStorage.removeItem("time"))}),1e3)},sendMessage(){this.countdown();const t=this.tel;t&&Ct({tel:t}).then((t=>{console.log(t),"200"===t.code?this.$notify({type:"danger",message:"验证码已发送"}):this.$notify({type:"danger",message:t.message})})).catch((t=>{console.log(t)}))},saveRemainTime(){0!==this.time&&localStorage.setItem("time",(new Date).getTime()+"_"+this.time)}}},At=Dt,Pt=(0,y.Z)(At,Zt,It,!1,null,"39508211",null),jt=Pt.exports,Et=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("van-field",{attrs:{type:"password",label:"密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),e("van-button",{attrs:{type:"danger",disabled:!t.btnFinishFlag,round:"",block:""},on:{click:t.handleFinished}},[t._v("完成")])],1)},Tt=[];const{mapState:Rt}=(0,$._p)("login");var Nt={data(){return{password:""}},methods:{handleFinished(){yt({tel:this.tel,password:this.password}).then((t=>{console.log(t),"200"===t.code&&this.$dialog.alert({message:"注册成功，立刻去登陆？"}).then((()=>{this.$router.go(-3)}))})).catch((t=>{console.error(t)}))}},computed:{...Rt(["tel"]),btnFinishFlag(){return/^\S*(?=\S{6,})(?=\S*\d)(?=\S*[A-Z])(?=\S*[a-z])(?=\S*[!@#$%^&*? ])\S*$/.test(this.password)}}},Gt=Nt,Ot=(0,y.Z)(Gt,Et,Tt,!1,null,"6c0db1ce",null),Vt=Ot.exports,Ft=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("van-nav-bar",{attrs:{title:"京东登录","left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),e("van-form",{attrs:{"validate-first":"","validate-trigger":"onChange",colon:""},on:{submit:t.onSubmit}},[e("van-field",{attrs:{name:"username",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),e("van-field",{attrs:{type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,pattern:t.pattern,message:"密码格式不正确"}]},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{round:"",block:"",type:"danger","native-type":"submit"}},[t._v(" 提交 ")])],1)],1),e("van-cell-group",{attrs:{inset:"",title:"去注册"}},[e("van-cell",{attrs:{title:"快速注册","is-link":"",to:"/register"}})],1)],1)},Ht=[],Ut={name:"LoginView",data(){return{username:"17512345666",password:"123abcOK!",pattern:/^\S*(?=\S{6,})(?=\S*\d)(?=\S*[A-Z])(?=\S*[a-z])(?=\S*[!@#$%^&*? ])\S*$/}},methods:{...(0,$.nv)("user",["loginAction"]),onSubmit(t){console.log("submit",t),this.loginAction(t)},onClickLeft(){this.$router.back()}}},zt=Ut,Bt=(0,y.Z)(zt,Ft,Ht,!1,null,"256d2884",null),Mt=Bt.exports,Jt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("van-nav-bar",{attrs:{title:`购物车(${t.totalNum})`,"left-text":"返回","left-arrow":""},on:{"click-left":t.onClickLeft}}),e("div",{staticClass:"list-container"},[e("van-pull-refresh",{on:{refresh:t.refresh},model:{value:t.isLoading,callback:function(e){t.isLoading=e},expression:"isLoading"}},[0===t.cartList.length?e("van-empty",{attrs:{description:"购物车无内容"}},[e("van-button",{staticClass:"bottom-button",attrs:{round:"",type:"danger"},on:{click:function(e){return t.$router.push("/")}}},[t._v(" 立即购物 ")])],1):t._e(),t._l(t.cartList,(function({proid:s,num:a,originprice:n,proname:o,img1:r,cartid:i},l){return e("van-swipe-cell",{key:s,scopedSlots:t._u([{key:"right",fn:function(){return[e("van-button",{staticClass:"delete-button",attrs:{square:"",text:"删除",type:"danger"},on:{click:function(e){return t.handleDeleteGood(i)}}})]},proxy:!0}],null,!0)},[e("div",{staticClass:"cell-left"},[e("van-checkbox",{on:{click:function(e){return t.handleSelectOne(i,t.cartList[l].flag)}},model:{value:t.cartList[l].flag,callback:function(e){t.$set(t.cartList[l],"flag",e)},expression:"cartList[index].flag"}}),e("van-card",{attrs:{tag:"标签",num:a,price:n,title:o,thumb:r,"thumb-link":`/#/details/${s}`},scopedSlots:t._u([{key:"num",fn:function(){return[e("van-stepper",{attrs:{theme:"round",name:i,"button-size":"22","disable-input":""},on:{change:t.handleChangeGoodNum},model:{value:t.cartList[l].num,callback:function(e){t.$set(t.cartList[l],"num",e)},expression:"cartList[index].num"}})]},proxy:!0}],null,!0)})],1)])}))],2),e("van-divider",[t._v("可能你还想要")]),e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.getRecommendlist},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[e("GoodsList",{ref:"goodList",attrs:{goodsList:t.recommendList}})],1),e("van-submit-bar",{attrs:{price:t.totalPrice,"button-text":"去结算"},on:{submit:t.onSubmit}},[e("van-checkbox",{on:{click:t.handleSelectAll},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v(" 全选 ")])],1)],1)],1)},Kt=[];const{mapState:Yt}=(0,$._p)("user"),Qt=(0,$._p)("cart");var Wt={name:"CartView",components:{GoodsList:x},data(){return{isLoading:!1,recommendlistCount:1,recommendList:[],loading:!1,finished:!1}},created(){this.getCartListData(this.userid),this.getRecommendlist()},computed:{...Yt(["userid"]),...Qt.mapState(["cartList"]),totalNum(){return this.cartList.filter((t=>t.flag)).reduce(((t,e)=>t+e.num),0)},totalPrice(){return 100*this.cartList.filter((t=>t.flag)).reduce(((t,e)=>t+e.originprice*e.num),0)},checked:{get(){return this.cartList.every((t=>t.flag))},set(t){console.log(t),this.cartList.forEach((e=>{e.flag=t}))}}},methods:{...Qt.mapActions(["getCartListData"]),onSubmit(){sessionStorage.setItem("selectedCartList",JSON.stringify(this.cartList.filter((t=>t.flag)))),this.$router.push("/order")},handleChangeGoodNum(t,{name:e}){K({cartid:e,num:t}).then((e=>{"200"===e.code&&console.log("change",t)}))},onClickLeft(){this.$router.go(-1)},refresh(){this.getCartListData(this.userid).then((()=>{this.isLoading=!1}))},getRecommendlist(){this.loading=!0,W({count:this.recommendlistCount++}).then((t=>{if(console.log("***",t),"200"===t.code){if(this.loading=!1,0===t.data.length)return this.finished=!0,!1;this.recommendList=t.data}})).catch((t=>console.error(t)))},handleDeleteGood(t){this.$dialog.confirm({message:"确认删除？",beforeClose:(e,s)=>{"confirm"===e?J({cartid:t}).then((e=>{"200"===e.code&&(this.cartList.splice(this.cartList.findIndex((e=>e.cartid===t)),1),s())})).catch((t=>console.error(t))):s()}})},handleSelectOne(t,e){Y({cartid:t,flag:e}).then((t=>{console.log(t)})).catch((t=>console.error(t)))},handleSelectAll(){Q({userid:this.userid,type:this.checked}).then((t=>{console.log("checkall",t)})).catch((t=>console.error(t)))}}},Xt=Wt,te=(0,y.Z)(Xt,Jt,Kt,!1,null,"01d74262",null),ee=te.exports,se=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"header"},[e("van-nav-bar",{attrs:{title:"个人中心","left-text":"返回","right-text":"退出","left-arrow":""},on:{"click-left":function(e){return t.$router.go(-1)},"click-right":t.onClickRight}})],1),e("div",{staticClass:"content"},[e("van-cell-group",{attrs:{inset:"",title:"个人中心"}},[e("van-cell",{attrs:{title:"地址管理","is-link":"",to:"/address"}}),e("van-cell",{attrs:{title:"订单中心","is-link":"",to:"/order"}})],1)],1)])},ae=[],ne={methods:{...(0,$.OI)("user",["setUserId"]),onClickRight(){this.setUserId(""),localStorage.removeItem("token"),this.$router.push("/")}}},oe=ne,re=(0,y.Z)(oe,se,ae,!1,null,"b1f82ee8",null),ie=re.exports,le=function(){var t=this,e=t._self._c;return e("div",{staticClass:"box"},[e("div",{staticClass:"search-header"},[e("van-search",{attrs:{"show-action":"",clearable:"",autofocus:"",placeholder:"请输入搜索关键词"},on:{search:t.searchHandler},scopedSlots:t._u([{key:"left",fn:function(){return[e("div",{staticClass:"search-left"},[e("van-icon",{attrs:{name:"arrow-left",size:"22"},on:{click:function(e){return t.$router.back()}}})],1)]},proxy:!0},{key:"action",fn:function(){return[e("div",{on:{click:t.searchHandler}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.query,callback:function(e){t.query=e},expression:"query"}})],1),e("div",{staticClass:"content"},[e("SearchList",{attrs:{dataList:t.hotSearchList,title:"搜索历史"}}),e("SearchList",{attrs:{dataList:t.hotSearchList,title:"热门搜索"}})],1)])},ce=[],de=(s(5041),s(4814)),ue=(s(6743),s(8848)),he=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-list-container"},[e("van-cell",{attrs:{title:t.title,value:"隐藏",size:"large"}}),e("div",{staticClass:"tagBox"},t._l(t.dataList,(function(s){return e("van-tag",{key:s.wordid,attrs:{color:"#efefef","text-color":"tomato"},on:{click:function(e){return t.handleSearchItemClick(s.keyword)}}},[t._v(" "+t._s(s.keyword)+" ")])})),1)],1)},me=[],pe={props:{dataList:{type:Array,required:!0},title:String},methods:{handleSearchItemClick(t){this.$parent.handleSearchItemClick(t)}}},ge=pe,fe=(0,y.Z)(ge,he,me,!1,null,"0edf2fe5",null),ve=fe.exports;function be(){return p.request({url:"/pro/hotword",method:"get"})}function ke(t){return p.request({url:"/pro/search",method:"get",params:{...t}})}a.ZP.use(ue.Z),a.ZP.use(de.Z);var Ce={name:"search-com",data(){return{query:"",hotSearchList:[]}},components:{SearchList:ve},methods:{toLoginHandler(){this.$router.back()},searchHandler(){this.query&&this.handleSearchItemClick(this.query)},handleSearchItemClick(t){ke({keyword:t}).then((t=>{console.log(t)}))}},mounted(){be().then((t=>{this.hotSearchList=t.data.filter((t=>""!==t.keyword&&void 0!==t.keyword))}))}},we=Ce,ye=(0,y.Z)(we,le,ce,!1,null,"0074c557",null),_e=ye.exports,xe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-container"},[e("van-nav-bar",{attrs:{title:"订单页","left-text":"返回","left-arrow":""},on:{"click-left":function(e){return t.$router.back()}}}),t.addrList.length>0?e("van-address-list",{attrs:{list:t.addrList,"default-tag-text":"默认",switchable:!1},on:{"click-item":t.onAdd}}):e("van-contact-card",{attrs:{type:"add","add-text":"添加地址"},on:{click:t.onAdd}}),e("div",{staticClass:"card-container"},[t._l(t.dataList,(function({proid:t,num:s,originprice:a,proname:n,img1:o}){return e("van-card",{key:t,attrs:{num:s,price:a,title:n,thumb:o}})})),0===t.dataList.length?e("van-empty",{attrs:{image:"error",description:"暂无订单"}}):t._e()],2),e("div",{staticClass:"order-footer"},[e("van-submit-bar",{attrs:{price:t.totalPrice,"button-text":"提交订单"},on:{submit:t.onSubmit}})],1)],1)},Le=[],Se={data(){return{dataList:[],addrList:[]}},computed:{totalPrice(){return 0===this.dataList.length?0:100*this.dataList.reduce(((t,e)=>t+e.originprice*e.num),0)}},created(){this.dataList=JSON.parse(sessionStorage.getItem("selectedCartList"))||[];const t=sessionStorage.getItem("currentAddr");t&&(this.addrList=[{...JSON.parse(t)}])},methods:{onAdd(){this.$router.push("/address")},onSubmit(){this.$toast("提交订单目前还未设置支付功能")}}},$e=Se,Ze=(0,y.Z)($e,xe,Le,!1,null,"654ef3d5",null),Ie=Ze.exports,qe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"address-container"},[e("van-nav-bar",{attrs:{title:"地址","left-text":"返回","left-arrow":""},on:{"click-left":function(e){return t.$router.back()}}}),e("van-address-list",{attrs:{list:t.list,"default-tag-text":"默认"},on:{add:t.onAdd,edit:t.onEdit},model:{value:t.chosenAddressId,callback:function(e){t.chosenAddressId=e},expression:"chosenAddressId"}}),e("van-popup",{style:{height:"70%"},attrs:{position:"bottom"},model:{value:t.showAddressEdit,callback:function(e){t.showAddressEdit=e},expression:"showAddressEdit"}},[e("van-address-edit",{attrs:{"area-list":t.areaList,"show-postal":"","show-delete":"","show-set-default":"","show-search-result":"","address-info":t.addressInfo,"search-result":t.searchResult,"area-columns-placeholder":["请选择","请选择","请选择"]},on:{save:t.onSave,delete:t.onDelete,"change-detail":t.onChangeDetail}})],1)],1)},De=[],Ae=s(2419),Pe={data(){return{list:[{id:"1",name:"张三",tel:"13000000000",province:"北京市",city:"北京市",county:"东城区",country:"",addressDetail:"杭州市西湖区 黄龙万科中心",areaCode:"110101",postalCode:"064100"},{id:"2",name:"李四",tel:"13100000000",province:"北京市",city:"北京市",county:"东城区",country:"",addressDetail:"杭州市西湖区 黄龙万科中心",areaCode:"110101",postalCode:"064100"},{id:"3",name:"王五",tel:"13800000000",province:"北京市",city:"北京市",county:"东城区",country:"",addressDetail:"杭州市西湖区 黄龙万科中心",areaCode:"110101",postalCode:"064100",isDefault:!0}],areaList:Ae.H,chosenAddressId:"3",searchResult:[],showAddressEdit:!1,addressInfo:{},currentIndex:-1}},created(){this.list.forEach((t=>{t.address=t.province+t.city+t.county+t.addressDetail}))},methods:{onAdd(){this.showAddressEdit=!0},onEdit(t,e){this.currentIndex=e,this.addressInfo=t,this.showAddressEdit=!0},formatDate(t){return t.address=t.province+t.city+t.county+t.addressDetail,t},onSave(t){t.isDefault&&delete this.list.find((t=>!0===t.isDefault)).isDefault,-1===this.currentIndex?this.list.push({id:(this.list.length+1).toString(),...t}):this.list[this.currentIndex]=this.formatDate(t),this.currentIndex=-1,this.addressInfo={},this.showAddressEdit=!1,this.$toast("save")},onDelete(){this.$toast("delete")},onChangeDetail(t){this.searchResult=t?[{name:"黄龙万科中心",address:"杭州市西湖区"}]:[]}},watch:{chosenAddressId(t){sessionStorage.setItem("currentAddr",JSON.stringify(this.list.find((e=>e.id===t))))}}},je=Pe,Ee=(0,y.Z)(je,qe,De,!1,null,null,null),Te=Ee.exports;a.ZP.use(o.Z);const Re=[{path:"/",name:"home",components:{default:E,footer:F}},{path:"/details/:id",name:"details",component:nt},{path:"/search",name:"search",component:_e},{path:"/order",name:"order",component:Ie},{path:"/address",name:"address",component:Te},{path:"/cart",name:"cart",meta:{needCheckLogin:!1},component:ee},{path:"/user",name:"user",meta:{needCheckLogin:!1},component:ie},{path:"/about",name:"about",component:()=>s.e(443).then(s.bind(s,3166))},{path:"/login",name:"login",component:Mt},{path:"/register",name:"register",component:ft,redirect:{name:"step1"},children:[{path:"step1",name:"step1",component:$t},{path:"step2",name:"step2",component:jt},{path:"step3",name:"step3",component:Vt}]},{path:"**",name:"notfound",component:dt}],Ne=new o.Z({routes:Re,scrollBehavior(t,e,s){return console.log("***",s),s||{x:0,y:0}}});Ne.beforeEach(((t,e,s)=>{if(t.matched[0].meta.needCheckLogin){const t=localStorage.getItem("token");t?s():(0,n.Z)({type:"warning",message:"请登录后访问",onClose:()=>{!t&&s({name:"login"})}})}else s()}));var Ge=Ne,Oe=(s(5739),s(6471)),Ve=(s(2443),s(9864)),Fe=(s(4607),s(9567)),He=(s(7119),s(5619)),Ue=(s(4913),s(4945)),ze=(s(6871),s(1765)),Be=(s(7938),s(2628)),Me=(s(319),s(9245)),Je=(s(292),s(6812)),Ke=(s(2680),s(8889)),Ye=(s(323),s(1698)),Qe=(s(7152),s(7304)),We=(s(7284),s(9057)),Xe=(s(4346),s(4329)),ts=(s(7180),s(3262)),es=(s(4439),s(6771)),ss=(s(1049),s(140)),as=(s(3391),s(5348)),ns=(s(7505),s(2594)),os=(s(836),s(6811)),rs=(s(139),s(9294)),is=(s(8867),s(541)),ls=(s(2679),s(3414)),cs=(s(4774),s(4898)),ds=(s(1640),s(4734)),us=(s(5825),s(9858)),hs=(s(7322),s(6631)),ms=(s(6791),s(4269)),ps=(s(8984),s(797)),gs=(s(6735),s(4319)),fs=(s(9061),s(2075)),vs=(s(6562),s(4159)),bs=(s(4825),s(7165)),ks=(s(3089),s(4398)),Cs=(s(5816),s(9387)),ws=(s(3686),s(9054));s(8675),s(3462),s(7380),s(1118);const ys=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce(((t,e)=>t+((e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_")),"");var _s=ys;const xs=[ws.Z,Cs.Z,ks.Z,bs.Z,vs.Z,fs.Z,gs.Z,ps.Z,ms.Z,hs.Z,ue.Z,us.Z,ds.Z,cs.Z,de.Z,ls.Z,is.Z,rs.Z,os.Z,ns.Z,as.Z,ss.Z,n.Z,es.Z,ts.Z,Xe.Z,We.Z,Qe.Z,Ye.Z,Ke.Z,Je.Z,Me.Z,Be.Z,ze.Z,Ue.Z,He.Z,Fe.Z,Ve.Z];var Ls={install(t){xs.forEach((e=>{t.use(e)})),t.prototype.$nanoid=_s,t.prototype.$imagePreview=Oe.Z}},Ss={namespaced:!0,state:{userid:localStorage.getItem("userid")||""},mutations:{setUserId(t,e){t.userid=e,localStorage.setItem("userid",e)}},actions:{loginAction({commit:t},e){_t({loginname:e.username,password:e.password}).then((e=>{"10010"===e.code?as.Z.confirm({message:e.message,confirmButtonText:"立即注册"}).then((()=>{Ge.push("/register")})).catch((()=>{})):(t("setUserId",e.data.userid),(0,n.Z)({type:"success",onClose:()=>{Ge.go(-1)},message:e.message}))})).catch((t=>{console.error(t)}))}}},$s={namespaced:!0,state:{tel:""},mutations:{setTel(t,e){t.tel=e}}},Zs={namespaced:!0,state:{tel:"",cartList:[]},mutations:{setTel(t,e){t.tel=e},updateCartList(t,e){t.cartList=e}},getters:{totalNum(t){return t.cartList.reduce(((t,e)=>t+e.num),0)}},actions:{getCartListData({commit:t},e){return new Promise(((s,a)=>{B({userid:e}).then((e=>{"10020"!==e.code&&t("updateCartList",e.data),s()})).catch((t=>{console.error(t),a()}))}))}}};a.ZP.use($.ZP);var Is=new $.ZP.Store({modules:{user:Ss,login:$s,cart:Zs}});a.ZP.config.productionTip=!1,a.ZP.use(Ls),s.e(704).then(s.bind(s,8704)).then((t=>{console.log(t),new a.ZP({router:Ge,store:Is,render:e=>e(t.default)}).$mount("#app")}))},4654:function(){}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[998],(function(){return e(9918)}));t.O()}]);
//# sourceMappingURL=app.500fc33e.js.map